<div class="dashboard-container">
    <header class="dashboard-header">
    <h1>Benvenuto, {{ currentUser?.firstName }}!</h1>
    <p class="subtitle">
        {{ currentUser?.role === 'agent' ? 'Gestisci i tuoi immobili e trova nuovi clienti' : 'Trova la casa dei tuoi sogni' }}
    </p>
    </header>

    <div class="dashboard-grid">
    <!-- Card per Ricerca -->
    <mat-card class="action-card">
        <mat-card-header>
        <mat-icon mat-card-avatar>search</mat-icon>
        <mat-card-title>Cerca Immobili</mat-card-title>
        <mat-card-subtitle>Trova la proprietà perfetta per te</mat-card-subtitle>
        </mat-card-header>
        <mat-card-actions>
        <button mat-raised-button color="primary" routerLink="/search">
            Inizia Ricerca
        </button>
        </mat-card-actions>
    </mat-card>

    <!-- Card per Ricerche Salvate -->
    <mat-card class="action-card">
        <mat-card-header>
        <mat-icon mat-card-avatar>bookmark</mat-icon>
        <mat-card-title>Ricerche Salvate</mat-card-title>
        <mat-card-subtitle>Visualizza le tue ricerche preferite</mat-card-subtitle>
        </mat-card-header>
        <mat-card-actions>
        <button mat-raised-button color="accent" routerLink="/saved-searches">
            Visualizza
        </button>
        </mat-card-actions>
    </mat-card>

    <!-- Card per Agenti (solo per agenti) -->
    <mat-card class="action-card" *ngIf="currentUser?.role === 'agent'">
        <mat-card-header>
        <mat-icon mat-card-avatar>home</mat-icon>
        <mat-card-title>I Miei Immobili</mat-card-title>
        <mat-card-subtitle>Gestisci le tue proprietà</mat-card-subtitle>
        </mat-card-header>
        <mat-card-actions>
        <button mat-raised-button color="primary" routerLink="/properties/upload">
            Carica Immobile
        </button>
        </mat-card-actions>
    </mat-card>

    <!-- Statistiche Utente -->
    <mat-card class="stats-card">
        <mat-card-header>
        <mat-icon mat-card-avatar>analytics</mat-icon>
        <mat-card-title>Le Tue Statistiche</mat-card-title>
        </mat-card-header>
        <mat-card-content>
        <div class="stats-grid">
            <div class="stat-item">
            <span class="stat-number">0</span>
            <span class="stat-label">Ricerche Salvate</span>
            </div>
            <div class="stat-item">
            <span class="stat-number">0</span>
            <span class="stat-label">Proprietà Preferite</span>
            </div>
            <div class="stat-item" *ngIf="currentUser?.role === 'agent'">
            <span class="stat-number">0</span>
            <span class="stat-label">Immobili Pubblicati</span>
            </div>
        </div>
        </mat-card-content>
    </mat-card>
    </div>

    <!-- Informazioni Account -->
    <mat-card class="account-card">
    <mat-card-header>
        <mat-icon mat-card-avatar>account_circle</mat-icon>
        <mat-card-title>Il Tuo Account</mat-card-title>
    </mat-card-header>
    <mat-card-content>
        <div class="account-info">
        <p><strong>Nome:</strong> {{ currentUser?.firstName }} {{ currentUser?.lastName }}</p>
        <p><strong>Email:</strong> {{ currentUser?.email }}</p>
        <!-- TODO <p *ngIf="currentUser?.phone"><strong>Telefono:</strong> {{ currentUser?.phone }}</p>
        <p><strong>Tipo Account:</strong>
            <mat-chip [color]="currentUser?.role === 'agent' ? 'accent' : 'primary'">
            {{ getUserRoleLabel() }}
            </mat-chip>
        </p>
        <div *ngIf="currentUser?.agency" class="agency-info">
          <p><strong>Agenzia:</strong> {{ currentUser?.agency?.name }}</p>
          <p *ngIf="currentUser?.agency?.description"><strong>Descrizione:</strong> {{ currentUser?.agency?.description }}</p>
          <p *ngIf="currentUser?.agency?.address"><strong>Indirizzo:</strong>
            {{ currentUser?.agency?.address }}
            <span *ngIf="currentUser?.agency?.address?.zipCode"> ({{ currentUser?.agency?.address?.zipCode }})</span>
            <span *ngIf="currentUser?.agency?.address?.city">, {{ currentUser?.agency?.address?.city }}</span>
          </p>
          <p *ngIf="currentUser?.agency?.phone"><strong>Telefono Agenzia:</strong> {{ currentUser?.agency?.phone }}</p>
          <p *ngIf="currentUser?.agency?.email"><strong>Email Agenzia:</strong> {{ currentUser?.agency?.email }}</p>
          <p *ngIf="currentUser?.agency?.website"><strong>Sito Web:</strong>
            <a [href]="currentUser?.agency?.website" target="_blank" rel="noopener">{{ currentUser?.agency?.website }}</a>
          </p>
        </div>
        <p *ngIf="currentUser?.licenseNumber"><strong>Licenza:</strong> {{ currentUser?.licenseNumber }}</p>
        <p><strong>Account Verificato:</strong>
            <mat-chip [color]="currentUser?.isVerified ? 'primary' : 'warn'">
            {{ currentUser?.isVerified ? 'Verificato' : 'Non Verificato' }}
            </mat-chip>
        </p>
        <p *ngIf="currentUser?.lastLoginAt"><strong>Ultimo Accesso:</strong> {{ formatDate(currentUser?.lastLoginAt) }}</p>
        <p><strong>Membro dal:</strong> {{ formatDate(currentUser?.createdAt) }}</p> -->
        </div>
    </mat-card-content>
    <mat-card-actions>
        <button mat-button color="primary" routerLink="/profile">Modifica Profilo</button>
        <button mat-button color="warn" (click)="logout()">Esci</button>
    </mat-card-actions>
    </mat-card>
</div>
